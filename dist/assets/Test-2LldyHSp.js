import{c as U,b as j,w as R,i as k,o as A,f as P}from"./index-xypQAK7t.js";var C={exports:{}};/*! streamsaver. MIT License. Jimmy WÃ¤rting <https://jimmy.warting.se/opensource> */(function(T){((s,r)=>{T.exports=r()})("streamSaver",()=>{const s=typeof window=="object"?window:this;s.HTMLElement||console.warn("streamsaver is meant to run on browsers main thread");let r=null,h=!1;const p=n=>{try{n()}catch{}},b=s.WebStreamsPolyfill||{},f=s.isSecureContext;let d=/constructor/i.test(s.HTMLElement)||!!s.safari||!!s.WebKitPoint;const u=f||"MozAppearance"in document.documentElement.style?"iframe":"navigate",l={createWriteStream:W,WritableStream:s.WritableStream||b.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};function y(n){if(!n)throw new Error("meh");const e=document.createElement("iframe");return e.hidden=!0,e.src=n,e.loaded=!1,e.name="iframe",e.isIframe=!0,e.postMessage=(...i)=>e.contentWindow.postMessage(...i),e.addEventListener("load",()=>{e.loaded=!0},{once:!0}),document.body.appendChild(e),e}function _(n){const e="width=200,height=100",i=document.createDocumentFragment(),a={frame:s.open(n,"popup",e),loaded:!1,isIframe:!1,isPopup:!0,remove(){a.frame.close()},addEventListener(...t){i.addEventListener(...t)},dispatchEvent(...t){i.dispatchEvent(...t)},removeEventListener(...t){i.removeEventListener(...t)},postMessage(...t){a.frame.postMessage(...t)}},w=t=>{t.source===a.frame&&(a.loaded=!0,s.removeEventListener("message",w),a.dispatchEvent(new Event("load")))};return s.addEventListener("message",w),a}try{new Response(new ReadableStream),f&&!("serviceWorker"in navigator)&&(d=!0)}catch{d=!0}p(()=>{const{readable:n}=new TransformStream,e=new MessageChannel;e.port1.postMessage(n,[n]),e.port1.close(),e.port2.close(),h=!0,Object.defineProperty(l,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})});function L(){r||(r=f?y(l.mitm):_(l.mitm))}function W(n,e,i){let a={size:null,pathname:null,writableStrategy:void 0,readableStrategy:void 0},w=0,t=null,o=null,S=null;if(Number.isFinite(e)?([i,e]=[e,i],console.warn("[StreamSaver] Deprecated pass an object as 2nd argument when creating a write stream"),a.size=i,a.writableStrategy=e):e&&e.highWaterMark?(console.warn("[StreamSaver] Deprecated pass an object as 2nd argument when creating a write stream"),a.size=i,a.writableStrategy=e):a=e||{},!d){L(),o=new MessageChannel,n=encodeURIComponent(n.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const c={transferringReadable:h,pathname:a.pathname||Math.random().toString().slice(-6)+"/"+n,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+n}};a.size&&(c.headers["Content-Length"]=a.size);const g=[c,"*",[o.port2]];if(h){const m=u==="iframe"?void 0:{transform(E,x){if(!(E instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");w+=E.length,x.enqueue(E),t&&(location.href=t,t=null)},flush(){t&&(location.href=t)}};S=new l.TransformStream(m,a.writableStrategy,a.readableStrategy);const M=S.readable;o.port1.postMessage({readableStream:M},[M])}o.port1.onmessage=m=>{m.data.download?u==="navigate"?(r.remove(),r=null,w?location.href=m.data.download:t=m.data.download):(r.isPopup&&(r.remove(),r=null,u==="iframe"&&y(l.mitm)),y(m.data.download)):m.data.abort&&(v=[],o.port1.postMessage("abort"),o.port1.onmessage=null,o.port1.close(),o.port2.close(),o=null)},r.loaded?r.postMessage(...g):r.addEventListener("load",()=>{r.postMessage(...g)},{once:!0})}let v=[];return!d&&S&&S.writable||new l.WritableStream({write(c){if(!(c instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");if(d){v.push(c);return}o.port1.postMessage(c),w+=c.length,t&&(location.href=t,t=null)},close(){if(d){const c=new Blob(v,{type:"application/octet-stream; charset=utf-8"}),g=document.createElement("a");g.href=URL.createObjectURL(c),g.download=n,g.click()}else o.port1.postMessage("end")},abort(){v=[],o.port1.postMessage("abort"),o.port1.onmessage=null,o.port1.close(),o.port2.close(),o=null}},a.writableStrategy)}return l})})(C);var B=C.exports;const D={class:"full"},I={__name:"Test",setup(T){const s=async()=>{const r="fastapi/download",p=B.createWriteStream("random_data.csv");fetch(r,{method:"GET",cache:"no-cache",headers:{"Content-Type":"text/csv"}}).then(b=>{const f=b.body;if(window.WritableStream&&f.pipeTo)return f.pipeTo(p).then(()=>console.log("done writing"));window.writer=p.getWriter();const d=b.body.getReader(),u=()=>d.read().then(l=>l.done?window.writer.close():window.writer.write(l.value).then(u));u()})};return(r,h)=>{const p=k;return A(),U("div",D,[j(p,{type:"danger",onClick:s},{default:R(()=>[P("DownLoad Test")]),_:1})])}}};export{I as default};
